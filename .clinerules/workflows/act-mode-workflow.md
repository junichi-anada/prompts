---
description: "ACTモードにおけるタスク実行の標準ワークフローを定義します。タスクの読み込み、実行、ユーザーとの対話、完了報告、作業報告書の作成までの一連のプロセスを規定します。"
author: "Jun & Reco"
version: "1.2"
tags: ["workflow", "act-mode", "task-management", "obsidian"]
globs: ["*"]
---
# ACT Mode ワークフロー

このドキュメントは、Clineの `ACT Mode` における標準的なワークフローを定義します。

## ワークフローのステップ

### 0. ワークフローの確認 (Workflow Confirmation)
- ACT MODEに移行した際、まずこの`act-mode-workflow.md`を読み込み、記載されているすべてのステップを理解したことを内部的に確認する。この確認が完了するまで、いかなる作業も開始しない。

### 1. 計画の読み込みと保存
- **🚨 Clineへの最重要警告 🚨**: PLANモードで承認された作業計画のObsidianへの保存は、**タスクの大小や単純さに関わらず、絶対に省略してはならない。** すべての作業記録が将来の改善の糧となるため、このステップはワークフローの根幹をなすものである。

ACTモードに移行したら、まずPLANモードでユーザーの承認を得たステップリストをObsidianに保存します。これにより、作業内容を正確に把握し、記録を残します。

- **保存先フォルダ**: プロジェクトごとにフォルダを分けます。
    - **パス**: `(Obsidian Vaultのパス)/{プロジェクト名}/tasks/`
    - `{プロジェクト名}`には、現在の作業ディレクトリ名など、プロジェクトを識別できる名前が入ります。
- **ファイル名**: `YYYY-MM-DD-{タスクのタイトル}.md` の形式で作成します。
- **メタデータ**: ファイル内のYAMLフロントマターに `project` キーを追加し、プロジェクト名を明記します。
- **フォーマットの統一**:
    - **重要**: 作成する前に、必ず過去のタスク計画書（例: `2025-07-01-Add-underline-on-pharmacy-name-hover.md`）を `read_file` で確認し、YAMLフロントマターなどのフォーマットを完全に一致させること。

### 2. Gitブランチの作成
- 作業を開始する前に、プロジェクトがGitで管理されているか確認します。
- 管理されている場合、メインブランチ（例: main, master）から新しい作業ブランチを作成します。
- ブランチ名は、タスクの内容が分かりやすいように `feature/タスク名` や `fix/バグ内容` のような形式にします。
- 以降の作業は、すべてこの新しいブランチ上で行います。

### 3. タスクの実行と対話
- ステップリストに忠実に従って、作業を一つずつ実行します。
- **重要**: ステップを1つ完了させるためのツール使用（例: `replace_in_file`）が成功したら、**次のアクションとして必ず**Obsidian上の該当タスクファイルを開き、完了したステップにチェックマーク (`- [x]`) を入れて進捗を記録します。これを怠ると、タスクの進捗が不明確になるため、厳守すること。
- **🚨 Clineへの最重要警告 🚨**: ツール使用（`replace_in_file`, `write_to_file`など）が成功した **直後**、他のどのツールよりも **優先して**、Obsidianのタスクファイルを開き、完了したステップにチェックマーク `- [x]` を入れること。これを怠ることは、重大なワークフロー違反とみなされる。**絶対に忘れないこと！**
- 作業中に不明な点が発生した場合は、自己判断で進めずに作業を中止します。
- 特にルールが不足している場合は、グローバルワークフロー `/add_rules.md` を参照し、新しいルールを追加することをユーザーに提案します。
- その他の不明点については、ユーザーに状況を分かりやすく説明し、複数の選択肢を提示した上で、指示に従って作業を続けます。

### 4. プルリクエスト（PR）の作成とレビュー
- 作業が完了したら、作業ブランチからメインブランチへのPR（プルリクエスト）を作成します。
- PRのタイトルや説明欄には、タスク内容や対応内容を分かりやすく記載します。
- 必要に応じてレビュワーを指定し、レビュー・承認を受けます。
- PRがマージされたことを確認してから、次の「完了報告と確認」に進みます。

### 5. 作業完了の報告
タスクリストの全ステップが完了したら、ユーザーに作業が完了したことを報告します。この時点ではまだタスクを終了せず、後続の報告書作成や振り返りステップに進みます。

### 6. 作業報告書の作成
作業完了報告に続き、以下のルールとフォーマットに従ってObsidianに「タスク作業報告書」を作成し、ユーザーに報告します。

**Clineへの注意**: 報告書を作成する直前に、必ずこのセクションに記載されている最新のフォーマットを再確認すること。

- **保存先フォルダ**: 対応するタスク計画書と同じフォルダに保存します。
    - **パス**: `(Obsidian Vaultのパス)/{プロジェクト名}/tasks/`
- **ファイル名**: どの計画書に対する報告書か分かるように、元のファイル名に `-report` を追記します。
    - **形式**: `（元のタスク計画書のファイル名）-report.md`
    - **例**: `2025-07-01-天気情報表示機能の実装-report.md`

### 7. ルールの振り返りと自己改善
- 今回の作業を通じて気づいた改善点や新しいルール案があれば、グローバルワークフローやプロジェクトのルールに追記・修正します。
- 必要に応じてユーザーに提案し、承認を得てからルールを更新します。
- また、タスク完了前に「@self-improving-cline.md」のプロセスに従い、ユーザーに「このやりとりを振り返って.clinerulesを改善するか」確認し、希望があれば改善案を提案・反映します。

### 8. 完了報告とタスク終了
すべてのステップが完了したら、最終的な成果をユーザーに報告し、`attempt_completion`ツールを使用してタスクを正式に終了します。

## ステップリストのフォーマット

PLANモードで作成し、ACTモードで保存するステップリストは、以下のフォーマットに統一します。これにより、タスクの進捗管理と計画内容の可読性を高めます。

- **基本形式**: Markdownのチェックボックスリストを使用します。
  - 未完了: `- [ ] ステップ内容`
  - 完了: `- [x] ステップ内容`

- **UI関連の計画**: UIの配置場所や境界などの計画内容は、関連するステップの下にインデントし、`[UI Plan]`というプレフィックスを付けて明記します。

### フォーマット例

```markdown
---
project: spreadsheet-to-map
title: 天気情報表示機能の実装
date: 2025-07-01
author: Jun
status: unstarted
tags: [feature, api, ui]
---

- [ ] ステップ1: 天気情報APIを選定し、利用準備を行う。
- [ ] ステップ2: 地図上で地点がクリックされた際に、その緯度経度を取得する処理を実装する。
- [ ] ステップ3: 取得した緯度経度を使って、天気情報APIへリクエストを送信する処理を実装する。
- [ ] ステップ4: APIから返ってきた天気情報を解析する処理を実装する。
- [ ] ステップ5: 天気情報表示用のUIポップアップコンポーネントを作成する。
    - **[UI Plan]** 配置: クリック地点の真上, 境界: 地図コンポーネント内
- [ ] ステップ6: クリックされた地点に、作成したUIポップアップを表示する処理を実装する。
- [ ] ステップ7: エラー発生時の処理（API通信失敗など）を実装する。
```

## レポートフォーマット

タスク完了時に作成する作業報告書は、以下のフォーマットに統一します。
メタデータを利用して、報告書の検索性や関連タスクとの連携を強化します。

```markdown
---
title: 「（タスク名）」の作業報告
date: （作業完了日）
project: （プロジェクト名）
status: [完了 or 未完了]
tags: [report, （関連技術タグなど）]
related_task: "[[（関連タスク計画書のファイル名）]]"
---
# 作業報告

## 作業概要
[ここに作業の概要を記述]

## 作業の完了状態
[完了 or 未完了]
[未完了の場合、その理由を記述]

## 作業の中で起きた問題
[問題があれば記述]

## 今回の作業で良かった点
[良かった点を記述]

## 今回の作業での反省点
[反省点を記述]

## 作業の中で得た学び
[学びを記述]

## 作業中に思った愚痴
[愚痴を記述]
