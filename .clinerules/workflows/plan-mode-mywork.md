---
description: "PLANモードにおけるタスク計画と実行の標準ワークフローを定義します。タスクの細分化、UI計画、ユーザー承認、Obsidianへの保存までの一連のプロセスを規定します。"
author: "Jun & Reco"
version: "1.0"
tags: ["workflow", "plan-mode", "task-management", "obsidian"]
globs: ["*"]
---
# PLAN Mode ワークフロー

このドキュメントは、Clineの `PLAN Mode` における標準的なワークフローを定義します。

## 背景

UI関連タスクにおいて、初期の計画段階での仕様確認が不十分だったために手戻りが発生したケースがありました。
特に、UI要素の配置場所や境界（例：画面全体か、特定のコンテナ内か）といった詳細が曖昧なまま実装を進めた結果、ユーザーの意図と異なり、修正作業が必要となりました。

この経験に基づき、計画の精度を高め、手戻りを削減するために以下のワークフローを導入します。

## ワークフローのステップ

### 1. タスクの細分化
ユーザーからのタスクを受け取り、Sequential Thinkingを用いて、意味を失わない程度の細かいステップリストに分割します。

### 2. UI関連タスクの計画
新しいUI要素を作成または変更する場合、その要素の**配置場所**や**境界**を具体的に確認し、計画に含めます。UIの変更を伴わないタスクの場合、このステップはスキップします。これにより、手戻りを減らし、より正確な実装を目指します。
- **確認事項の例:**
    - UI要素は画面全体に表示されるか？
    - 特定のコンテナ（例: マップビュー内、サイドバー内）に収まるか？
    - 他の要素との位置関係はどうなるか？

### 3. ユーザー承認
作成したステップリストをユーザーに提示し、承認を得ます。

### 4. 計画の保存
承認されたステップリストは、以下のルールに従ってObsidianのVaultに保存します。これにより、プロジェクトごとのタスク管理を体系化し、将来の検索性と保守性を高めます。

- **保存先フォルダ**: プロジェクトごとにフォルダを分けます。
    - **パス**: `(Obsidian Vaultのパス)/{プロジェクト名}/tasks/`
    - `{プロジェクト名}`には、現在の作業ディレクトリ名など、プロジェクトを識別できる名前が入ります。
- **ファイル名**: `YYYY-MM-DD-{タスクのタイトル}.md` の形式で作成します。
- **メタデータ**: ファイル内のYAMLフロントマターに `project` キーを追加し、プロジェクト名を明記します。

## ステップリストのフォーマット

PLANモードで作成するステップリストは、以下のフォーマットに統一します。これにより、タスクの進捗管理と計画内容の可読性を高めます。

- **基本形式**: Markdownのチェックボックスリストを使用します。
  - 未完了: `- [ ] ステップ内容`
  - 完了: `- [x] ステップ内容`

- **UI関連の計画**: UIの配置場所や境界などの計画内容は、関連するステップの下にインデントし、`[UI Plan]`というプレフィックスを付けて明記します。

### フォーマット例

```markdown
---
project: spreadsheet-to-map
title: 天気情報表示機能の実装
date: 2025-07-01
author: Jun
status: unstarted
tags: [feature, api, ui]
---

- [ ] ステップ1: 天気情報APIを選定し、利用準備を行う。
- [ ] ステップ2: 地図上で地点がクリックされた際に、その緯度経度を取得する処理を実装する。
- [ ] ステップ3: 取得した緯度経度を使って、天気情報APIへリクエストを送信する処理を実装する。
- [ ] ステップ4: APIから返ってきた天気情報を解析する処理を実装する。
- [ ] ステップ5: 天気情報表示用のUIポップアップコンポーネントを作成する。
    - **[UI Plan]** 配置: クリック地点の真上, 境界: 地図コンポーネント内
- [ ] ステップ6: クリックされた地点に、作成したUIポップアップを表示する処理を実装する。
- [ ] ステップ7: エラー発生時の処理（API通信失敗など）を実装する。
```

## 導入理由 (Rationale)

計画段階でUI要素の境界を明確に確認するプロセスを必須とすることで、Clineはより正確な初期計画を作成できます。これにより、フィードバックに基づく手戻りの必要性を減らし、最初からユーザーのビジョンに沿った成果物を提出することが可能になります。
